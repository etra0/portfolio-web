<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Black and White</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.core.min.css">
  <link href="https://fonts.googleapis.com/css?family=Merriweather:400,700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Playfair+Display:700&display=swap" rel="stylesheet">
</head>
<body>
  <h1 class="mobile-header"><a href="/">Sebastián Aedo</a></h1>
  <div class="sidebar">
    <h1><a class="sidebar-title" href="/">Sebastián Aedo</a></h1>
    <ul>
      
        <li><a href="/categories/black-and-white/">Black and White</a></li>
      
        <li><a href="/categories/color/">Color</a></li>
      
        <li><a href="/categories/film/">Film</a></li>
      
        <li><a href="/categories/wildlife/">Wildlife</a></li>
      
    </ul>
    <div class="sidebar-bottom">
      <a href="/about/">About</a>
    </div>
  </div>
  <div id="sidebar-overlay"></div>
  <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Show navigation">&#9776;</button>
  <main>
    
<h2>Black and White</h2>

<div class="gallery-grid">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/DSCF3027.jpg" alt="The passage of time" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/DSCF3027.jpg', 'The passage of time',  0 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/DSCF3119.jpg" alt="The portal" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/DSCF3119.jpg', 'The portal',  1 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/IMG_3759.jpg" alt="Aurora" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/IMG_3759.jpg', 'Aurora',  2 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/P1000758.jpg" alt="Birds" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/P1000758.jpg', 'Birds',  3 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/20241031-130812296.jpg" alt="Marching band" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/20241031-130812296.jpg', 'Marching band',  4 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/P1000170.jpg" alt="Window to the future" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/P1000170.jpg', 'Window to the future',  5 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/DSCF3111.jpg" alt="Spain" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/DSCF3111.jpg', 'Spain',  6 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/DSCF2981-Pano.jpg" alt="Spain Castle" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/DSCF2981-Pano.jpg', 'Spain Castle',  7 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/IMG_4460.jpg" alt="Quixote" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/IMG_4460.jpg', 'Quixote',  8 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/IMG_4511.jpg" alt="Chajnantor" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/IMG_4511.jpg', 'Chajnantor',  9 )">
  
    <img src="https://pics.etra0.cl/black&#43;and&#43;white/P1001087.jpg" alt="Flying" onclick="expandImage('https:\/\/pics.etra0.cl\/black\u002band\u002bwhite\/P1001087.jpg', 'Flying',  10 )">
  
</div>
<div id="expanded-view" class="expanded-view">
  <button class="arrow left" onclick="prevImage(event)">&#8592;</button>
  <div class="expanded-img-container">
    <img id="expanded-img" src="" alt="">
    <p id="expanded-caption"></p>
  </div>
  <button class="arrow right" onclick="nextImage(event)">&#8594;</button>
  <button class="close-btn" onclick="closeExpanded()">×</button>
</div>

  </main>
  <script src="https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/glide.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      
      document.querySelectorAll(".glide").forEach(function (carousel) {
        new Glide(carousel, { type: 'carousel', perView: 1, focusAt: 'center' }).mount();
      });

      
      const container = document.querySelector('.gallery-grid');
      if (container) {
        const gap = 8;
        const targetRowHeight = 600; 
        const images = Array.from(container.querySelectorAll('img'));

        function layout() {
          container.innerHTML = '';
          let row = [];
          let rowAspectSum = 0;
          const containerWidth = container.clientWidth;

          images.forEach((img, i) => {
            const aspect = img.naturalWidth / img.naturalHeight;
            row.push(img);
            rowAspectSum += aspect;

            const rowWidth = rowAspectSum * targetRowHeight + gap * (row.length - 1);

            if (rowWidth >= containerWidth || i === images.length - 1) {
              const totalGap = gap * (row.length - 1);
              const rowHeight = Math.min(targetRowHeight, (containerWidth - totalGap) / rowAspectSum);

              const rowDiv = document.createElement('div');
              rowDiv.className = 'gallery-row';

              row.forEach(imgInRow => {
                const aspect = imgInRow.naturalWidth / imgInRow.naturalHeight;
                const imgClone = imgInRow.cloneNode();
                imgClone.style.height = rowHeight + 'px';
                imgClone.style.width = (rowHeight * aspect) + 'px';
                rowDiv.appendChild(imgClone);
              });

              container.appendChild(rowDiv);
              row = [];
              rowAspectSum = 0;
            }
          });
          container.classList.add('loaded');
          updateGalleryImages(); 
        }

        
        let loaded = 0;
        images.forEach(img => {
          if (img.complete) loaded++;
          else img.addEventListener('load', () => {
            loaded++;
            if (loaded === images.length) layout();
          });
        });
        if (loaded === images.length) layout();

        window.addEventListener('resize', layout);

        
        function updateGalleryImages() {
          galleryImages = Array.from(container.querySelectorAll('img'));
          galleryImages.forEach((img, idx) => {
            img.setAttribute('data-caption', img.getAttribute('alt') || '');
            img.onclick = function() { expandImage(img.src, img.getAttribute('alt') || '', idx); };
          });
        }
        
        window.addEventListener('resize', updateGalleryImages);
        if (loaded === images.length) updateGalleryImages();
      }

      
      const sidebar = document.querySelector('.sidebar');
      const toggleBtn = document.getElementById('sidebar-toggle');
      const overlay = document.getElementById('sidebar-overlay');
      if (toggleBtn && sidebar && overlay) {
        toggleBtn.addEventListener('click', function() {
          sidebar.classList.add('open');
          overlay.classList.add('active');
        });
        overlay.addEventListener('click', function() {
          sidebar.classList.remove('open');
          overlay.classList.remove('active');
        });
      }
    });

    let currentIndex = 0;
let galleryImages = [];

function expandImage(url, caption, index) {
  const expandedView = document.getElementById('expanded-view');
  document.getElementById('expanded-img').src = url;
  document.getElementById('expanded-caption').textContent = caption;
  expandedView.classList.add('active');
  currentIndex = index;
}

function closeExpanded() {
  document.getElementById('expanded-view').classList.remove('active');
  document.getElementById('expanded-img').src = '';
  document.getElementById('expanded-caption').textContent = '';
}

function prevImage(e) {
  e.stopPropagation();
  if (galleryImages.length === 0) return;
  currentIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
  showCurrentImage();
}

function nextImage(e) {
  e.stopPropagation();
  if (galleryImages.length === 0) return;
  currentIndex = (currentIndex + 1) % galleryImages.length;
  showCurrentImage();
}

function showCurrentImage() {
  const img = galleryImages[currentIndex];
  expandImage(img.src, img.getAttribute('data-caption'), currentIndex);
}

document.addEventListener("keydown", function(e) {
  const expandedView = document.getElementById('expanded-view');
  if (!expandedView || !expandedView.classList.contains('active')) return;

  if (e.key === "ArrowLeft") {
    prevImage(e);
  } else if (e.key === "ArrowRight") {
    nextImage(e);
  } else if (e.key === "Escape") {
    closeExpanded();
  }
});
</script>
</body>
</html>
